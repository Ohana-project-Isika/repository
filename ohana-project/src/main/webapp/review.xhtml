<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/WEB-INF/templates/default.xhtml">

    <ui:define name="content">
        <h:outputStylesheet library="css" name="styles.css"  />
        <script type="text/javascript" src="#{request.contextPath}/resources/js/ticketing.js"></script>

        <h1>Vérifiez votre commande avant de payer</h1>

        <b>Détails :</b>

        <h:form id="test">

            <h:dataTable value="#{eventController.cart.events}" var="event">
                <h:column>
                    <f:facet name="header">Nom</f:facet>
                    #{event.name}
                </h:column>

                <h:column>
                    <f:facet name="header">Nombre de tickets</f:facet>
                    #{event.ticketQuantity}
                </h:column>

                <h:column>
                    <f:facet name="header">Tarif</f:facet>
                    #{event.ticket.rateType}
                </h:column>

                <h:column>
                    <f:facet name="header">Taux TVA</f:facet>
                    #{event.ticket.tvaRate} %
                </h:column>+

                <h:column>
                    <f:facet name="header">Prix HT</f:facet>
                    <input type="text" id="preTax_#{event.id}" value="#{event.ticket.preTaxPrice}"/>
                </h:column>

                <h:column>
                    <f:facet name="header">Prix TTC</f:facet>
                    <input type="text" id="postTax_#{event.id}" value="#{event.ticket.postTaxPrice}"/>
                </h:column>

                <h:column >
                    <input type="button" onclick="decrement('#{event.id}')" value="-"/>
                    <input class="byAmount" id="#{event.id}" type="number" value="1" min="1" max="#{event.ticketQuantity}"/>
                    <input type="button" onclick="increment('#{event.id}')" value="+"/>
                </h:column>

                <h:column >
                </h:column>

                <h:column>
                    <f:facet name="header">Total HT</f:facet>
                    <p id="subTotal_#{event.id}" >
                        #{event.ticket.preTaxPrice}
                    </p>
                </h:column>

                <h:column>
                    <f:facet name="header">Total TTC</f:facet>
                    <p id="total_#{event.id}" >
                        #{event.ticket.postTaxPrice}
                    </p>
                </h:column>
            </h:dataTable>

            <h:column>
                <f:facet name="header">Total Panier HT</f:facet>
                <p id="cartSubTotal">
                    #{eventController.cart.subTotal}
                </p>
            </h:column>
            <h:column>
                <f:facet name="header">Total Panier TTC</f:facet>
                <p id="cartTotal">
                    #{eventController.cart.total}
                </p>
            </h:column>
            <a href="#"><p onclick="getVars('#{eventController.cart.subTotal}', '#{eventController.cart.total}')">Payer</p></a>
            <div hidden="hidden">
                <h:inputHidden id="subTotal" value="#{authorizePaymentController.cartSubTotal}" />
                <h:inputHidden id="total" value="#{authorizePaymentController.cartTotal}" />
                <h:commandLink id="link" action="#{authorizePaymentController.pay(eventController.cart)}"
                               value="click"/>
            </div>
        </h:form>

    </ui:define>
</ui:composition>
